<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Part 14 - 課程認證測驗</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; overflow: hidden; color: #333; }
        .nav-bar { position: fixed; top: 0; left: 0; right: 0; height: 60px; background: rgba(255,255,255,0.15); backdrop-filter: blur(12px); display: flex; justify-content: space-between; align-items: center; padding: 0 30px; z-index: 10000; }
        .nav-title { font-size: 20px; font-weight: 700; color: #fff; }
        .nav-buttons { display: flex; gap: 12px; align-items: center; }
        .nav-btn { background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.4); color: white; padding: 6px 16px; border-radius: 20px; cursor: pointer; font-size: 14px; font-weight: 600; text-decoration: none; }
        .nav-btn:hover { background: rgba(255,255,255,0.4); }
        .nav-arrow { position: fixed; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.25); color: white; width: 60px; height: 60px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.4); font-size: 24px; cursor: pointer; z-index: 9000; display: flex; align-items: center; justify-content: center; }
        .nav-arrow:hover { background: rgba(255,255,255,0.5); transform: translateY(-50%) scale(1.1); }
        .prev-arrow { left: 30px; } .next-arrow { right: 30px; }
        .nav-arrow:disabled { opacity: 0.3; cursor: not-allowed; }
        .slide { position: absolute; top: 60px; left: 0; width: 100%; height: calc(100vh - 60px); display: none; align-items: center; justify-content: center; padding: 40px; opacity: 0; transition: opacity 0.4s ease; }
        .slide.active { display: flex; opacity: 1; z-index: 20; }
        .content-card { background: rgba(255,255,255,0.98); border-radius: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); padding: 30px 40px; max-width: 1400px; width: 95%; max-height: 88vh; overflow-y: auto; }
        h1 { color: #667eea; font-size: 38px; margin-bottom: 16px; text-align: center; font-weight: 800; }
        h2 { color: #764ba2; font-size: 26px; margin-bottom: 16px; border-bottom: 3px solid #667eea; padding-bottom: 8px; }
        h3 { color: #667eea; font-size: 19px; margin: 14px 0 8px 0; }
        p, li { font-size: 15px; line-height: 1.65; color: #444; margin-bottom: 6px; }
        ul, ol { margin-left: 22px; margin-bottom: 12px; }
        .box { padding: 10px 15px; border-radius: 10px; margin: 10px 0; border-left: 4px solid; font-size: 14px; }
        .info { background: #e3f2fd; border-color: #2196f3; color: #0d47a1; }
        .warning { background: #fff3cd; border-color: #ffc107; color: #856404; }
        .success { background: #d4edda; border-color: #28a745; color: #155724; }
        .tag-badge { display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 4px 12px; border-radius: 15px; font-size: 13px; margin: 2px; }
        .cover-content { text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 50vh; }
        .cover-content h1 { font-size: 44px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .cover-subtitle { font-size: 22px; color: #764ba2; margin-bottom: 20px; }
        .cover-info { font-size: 15px; color: #888; margin-top: 25px; }
        .indicators { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 4px; z-index: 4000; padding: 8px 15px; background: rgba(0,0,0,0.3); border-radius: 25px; backdrop-filter: blur(5px); flex-wrap: wrap; max-width: 90%; justify-content: center; }
        .dot { width: 8px; height: 8px; background: rgba(255,255,255,0.4); border-radius: 50%; cursor: pointer; }
        .dot.active { background: #fff; transform: scale(1.4); }

        /* === Quiz Styles === */
        .quiz-card { background: linear-gradient(160deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px 40px; }
        .quiz-card h1 { color: white; -webkit-text-fill-color: white; border-bottom: 3px solid rgba(255,255,255,0.3); padding-bottom: 12px; font-size: 34px; }
        .quiz-container { background: rgba(255,255,255,0.95); border-radius: 15px; padding: 25px; margin: 15px 0; color: #333; max-height: 55vh; overflow-y: auto; }
        .quiz-question { margin-bottom: 20px; padding: 18px; background: #f8f9ff; border-radius: 12px; border-left: 4px solid #667eea; }
        .quiz-question h4 { color: #667eea; margin-bottom: 12px; font-size: 17px; }
        .quiz-option { display: block; padding: 10px 14px; margin: 6px 0; background: white; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-size: 15px; }
        .quiz-option:hover { border-color: #667eea; background: #f0f2ff; }
        .quiz-option.selected { border-color: #667eea; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); color: white; }
        .quiz-option.correct { border-color: #28a745; background: #d4edda; color: #155724; }
        .quiz-option.wrong { border-color: #dc3545; background: #f8d7da; color: #721c24; }
        .quiz-btn { display: inline-block; padding: 14px 36px; background: linear-gradient(90deg, #ffd700 0%, #ff6b35 100%); color: #333; border: none; border-radius: 30px; font-size: 17px; font-weight: bold; cursor: pointer; transition: all 0.3s; margin: 8px; }
        .quiz-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4); }
        .quiz-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .quiz-result { text-align: center; padding: 25px; background: rgba(255,255,255,0.1); border-radius: 15px; margin-top: 15px; }
        .quiz-score { font-size: 72px; font-weight: bold; color: #ffd700; }
        .quiz-pass { color: #90EE90; font-size: 24px; margin: 15px 0; }
        .quiz-fail { color: #ffb3b3; font-size: 24px; margin: 15px 0; }

        /* === Certificate Form === */
        .cert-form { background: rgba(255,255,255,0.95); border-radius: 15px; padding: 30px; margin: 20px 0; color: #333; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #555; }
        .form-group input { width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 16px; font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif; }
        .form-group input:focus { outline: none; border-color: #667eea; }

        /* === Certificate === */
        .certificate-card { background: linear-gradient(160deg, #1a1a2e 0%, #16213e 100%); display: flex; flex-direction: column; align-items: center; padding: 30px 40px; }
        .certificate { width: 900px; height: 640px; background: linear-gradient(135deg, #fffef0 0%, #fff8dc 50%, #ffefd5 100%); border: 15px solid; border-image: linear-gradient(135deg, #ffd700 0%, #b8860b 50%, #ffd700 100%) 1; padding: 50px; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.4); }
        .certificate::before { content: ''; position: absolute; inset: 10px; border: 2px solid #b8860b; pointer-events: none; }
        .certificate-header h1 { font-size: 36px; color: #8b4513; text-align: center; border: none; -webkit-text-fill-color: #8b4513; margin-bottom: 5px; }
        .certificate-subtitle { font-size: 16px; color: #b8860b; letter-spacing: 5px; text-align: center; }
        .certificate-body { text-align: center; margin: 25px 0; }
        .certificate-body .recipient { font-size: 36px; font-weight: bold; color: #2c3e50; margin: 15px 0; }
        .certificate-body .org { font-size: 16px; color: #666; }
        .certificate-body .congrats { font-size: 18px; color: #555; line-height: 1.8; }
        .certificate-course { background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 25px; border-radius: 30px; font-size: 15px; font-weight: bold; display: inline-block; margin: 20px 0; }
        .certificate-footer { display: flex; justify-content: space-between; margin-top: 25px; padding-top: 15px; border-top: 2px dashed #b8860b; }
        .footer-item { text-align: center; }
        .footer-item .line { width: 180px; height: 2px; background: #333; margin: 10px auto 0; }
        .footer-item .label { font-size: 13px; color: #666; }
        .footer-item .value { font-size: 15px; color: #333; font-weight: 600; }
        .cert-seal { position: absolute; top: 40px; left: 40px; width: 110px; height: 110px; border: 4px solid #c41e3a; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(255,255,255,0.9); transform: rotate(-15deg); box-shadow: 0 4px 15px rgba(196, 30, 58, 0.3); }
        .cert-seal::before { content: ''; position: absolute; inset: 6px; border: 2px dashed #c41e3a; border-radius: 50%; }
        .cert-seal .seal-icon { font-size: 24px; color: #c41e3a; }
        .cert-seal .seal-text { font-size: 10px; color: #c41e3a; font-weight: bold; }
        .cert-seal .seal-text-lg { font-size: 13px; color: #c41e3a; font-weight: bold; }
        .download-btn { padding: 14px 32px; background: linear-gradient(90deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 30px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        .download-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4); }
        .hidden { display: none !important; }

        @media (max-width: 960px) {
            .certificate { width: 95vw; height: auto; min-height: 480px; padding: 25px; }
            .certificate-header h1 { font-size: 26px; }
            .certificate-body .recipient { font-size: 26px; }
            .cert-seal { width: 80px; height: 80px; top: 20px; left: 20px; }
            .cert-seal .seal-icon { font-size: 18px; }
            .cert-seal .seal-text-lg { font-size: 10px; }
            .footer-item .line { width: 120px; }
        }
    </style>
</head>
<body>
    <div class="nav-bar">
        <div class="nav-title">Part 14 - 課程認證測驗</div>
        <div class="nav-buttons">
            <a href="Day2.html" class="nav-btn">首頁</a>
            <a href="Part13_上線測試與課程總結.html" class="nav-btn">&larr; 上一章</a>
            <button class="nav-btn" onclick="toggleFullscreen()">全螢幕</button>
            <span class="nav-btn" id="pageIndicator">1 / 3</span>
        </div>
    </div>

    <button class="nav-arrow prev-arrow" id="prevBtn" onclick="changeSlide(-1)">&larr;</button>
    <button class="nav-arrow next-arrow" id="nextBtn" onclick="changeSlide(1)">&rarr;</button>

    <div class="slide-container">

        <!-- Slide 1: 封面 -->
        <div class="slide active">
            <div class="content-card cover-content">
                <h1>課程認證測驗</h1>
                <p class="cover-subtitle">AI 協作簡報實戰～從手繪到上線 GitHub 的 HTML 簡報製作</p>
                <div style="margin: 25px 0;">
                    <span class="tag-badge" style="font-size: 15px; padding: 8px 18px;">隨機抽 10 題</span>
                    <span class="tag-badge" style="font-size: 15px; padding: 8px 18px;">每題 10 分</span>
                    <span class="tag-badge" style="font-size: 15px; padding: 8px 18px;">80 分及格</span>
                </div>
                <div class="box info" style="max-width: 600px; text-align: left;">
                    <strong>測驗說明：</strong>
                    <ul style="margin-top: 8px;">
                        <li>系統會從題庫中隨機抽取 <strong>10 題</strong></li>
                        <li>每題 10 分，共 100 分</li>
                        <li>達到 <strong>80 分</strong>（答對 8 題）即通過認證</li>
                        <li>通過後可填寫姓名，下載認證證書</li>
                        <li>未通過可重新作答（題目會重新抽選）</li>
                    </ul>
                </div>
                <p style="font-size: 14px; color: #888; margin-top: 20px;">認證單位：謝教授AI前瞻教室　曾慶良（阿亮老師）</p>
                <div style="margin-top: 25px;">
                    <button class="quiz-btn" onclick="goToSlide(1)">開始測驗 &rarr;</button>
                </div>
            </div>
        </div>

        <!-- Slide 2: 測驗 -->
        <div class="slide">
            <div class="content-card quiz-card">
                <h1>課程認證測驗</h1>
                <p style="text-align: center; margin-bottom: 10px;">從題庫隨機抽取 10 題，每題 10 分，達 80 分即通過認證！</p>

                <div id="quizContainer" class="quiz-container"></div>

                <div id="quizResult" class="quiz-result hidden">
                    <h2 style="color: white; border: none;">測驗結果</h2>
                    <div class="quiz-score" id="scoreDisplay">0</div>
                    <div id="resultMessage"></div>
                </div>

                <div style="text-align: center; margin-top: 15px;">
                    <button id="submitQuizBtn" class="quiz-btn" onclick="submitQuiz()">送出答案</button>
                    <button id="retryQuizBtn" class="quiz-btn hidden" onclick="resetQuiz()">重新作答</button>
                    <button id="getCertBtn" class="quiz-btn hidden" onclick="goToSlide(2)">取得證書 &rarr;</button>
                </div>
            </div>
        </div>

        <!-- Slide 3: 證書 -->
        <div class="slide">
            <div class="content-card certificate-card">
                <!-- 輸入表單 -->
                <div id="certForm" class="cert-form" style="max-width: 500px; width: 100%;">
                    <h3 style="color: #667eea; text-align: center; margin-bottom: 20px; font-size: 22px;">填寫證書資訊</h3>
                    <div class="form-group">
                        <label for="recipientName">姓名 *</label>
                        <input type="text" id="recipientName" placeholder="請輸入您的姓名">
                    </div>
                    <div class="form-group">
                        <label for="recipientOrg">單位（選填）</label>
                        <input type="text" id="recipientOrg" placeholder="例如：XX 學校 / XX 公司">
                    </div>
                    <div style="text-align: center;">
                        <button class="quiz-btn" onclick="generateCertificate()">生成證書</button>
                    </div>
                </div>

                <!-- 證書顯示 -->
                <div id="certificateDisplay" class="hidden">
                    <div id="certificate" class="certificate">
                        <!-- 認證印章 -->
                        <div class="cert-seal">
                            <div class="seal-icon">&#x2713;</div>
                            <div class="seal-text-lg">CERTIFIED</div>
                            <div class="seal-text">認證通過</div>
                        </div>
                        <div class="certificate-header">
                            <h1>AI 協作簡報實戰能力認證證書</h1>
                            <div class="certificate-subtitle">CERTIFICATE OF ACHIEVEMENT</div>
                        </div>
                        <div class="certificate-body">
                            <p style="font-size: 16px; color: #666;">茲證明</p>
                            <div class="recipient" id="certName">學員姓名</div>
                            <div class="org" id="certOrg"></div>
                            <p class="congrats">恭喜您完成專業課程學習並通過認證測驗</p>
                            <div class="certificate-course">AI 協作簡報實戰～從手繪到上線 GitHub 的 HTML 簡報製作</div>
                        </div>
                        <div class="certificate-footer">
                            <div class="footer-item">
                                <div class="label">發證日期</div>
                                <div class="value" id="certDate"></div>
                                <div class="line"></div>
                            </div>
                            <div class="footer-item">
                                <div class="label">認證單位</div>
                                <div class="value">謝教授AI前瞻教室<br>曾慶良（阿亮老師）</div>
                                <div class="line"></div>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 25px; text-align: center;">
                        <button class="download-btn" onclick="downloadCertificate()">&#x1F4E5; 下載證書（PNG）</button>
                        <button class="quiz-btn" style="margin-left: 10px;" onclick="goToSlide(0)">回到首頁</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="indicators" id="indicatorContainer"></div>

    <script>
        // ========== 題庫（20 題，涵蓋 Day 1 + Day 2）==========
        const allQuestions = [
            // --- Day 1 題目 ---
            {
                question: "HTML 的全名是什麼？",
                options: ["Hyper Text Markup Language", "High Tech Modern Language", "Home Tool Markup Language", "Hyper Transfer Markup Language"],
                answer: 0
            },
            {
                question: "在 HTML 中，哪個標籤用來建立超連結？",
                options: ["&lt;link&gt;", "&lt;a&gt;", "&lt;href&gt;", "&lt;url&gt;"],
                answer: 1
            },
            {
                question: "Reveal.js 是用來做什麼的框架？",
                options: ["資料庫管理", "HTML 簡報製作", "影片剪輯", "圖片編輯"],
                answer: 1
            },
            {
                question: "在 Reveal.js 簡報中，每一頁投影片使用哪個 HTML 標籤？",
                options: ["&lt;div&gt;", "&lt;page&gt;", "&lt;section&gt;", "&lt;slide&gt;"],
                answer: 2
            },
            {
                question: "撰寫 AI Prompt 的三要素是什麼？",
                options: ["標題、內容、結尾", "角色設定、任務描述、格式要求", "問題、答案、解說", "開頭、中間、結尾"],
                answer: 1
            },
            {
                question: "在 HTML 中，class 屬性的主要用途是什麼？",
                options: ["建立超連結", "為元素套用 CSS 樣式", "設定圖片來源", "定義網頁標題"],
                answer: 1
            },
            {
                question: "NotebookLM 是由哪家公司開發的？",
                options: ["Microsoft", "Apple", "Google", "Meta"],
                answer: 2
            },
            {
                question: "CSS 主要用來做什麼？",
                options: ["撰寫程式邏輯", "控制網頁的外觀和樣式", "管理資料庫", "處理伺服器請求"],
                answer: 1
            },
            {
                question: "HTML 中的 &lt;h1&gt; 到 &lt;h6&gt; 標籤代表什麼？",
                options: ["段落大小", "標題層級（h1 最大，h6 最小）", "字體種類", "連結等級"],
                answer: 1
            },
            {
                question: "什麼是 Wireframe（線框圖）？",
                options: ["用線條連接電腦的技術", "網頁設計的初步草稿或骨架", "一種程式語言", "CSS 的排版方式"],
                answer: 1
            },
            // --- Day 2 題目 ---
            {
                question: "瀑布式卡片網頁與 Reveal.js 簡報最大的差異是什麼？",
                options: ["瀑布式不能放圖片", "瀑布式用滾動瀏覽，Reveal.js 用切換頁面", "瀑布式只能在手機上看", "Reveal.js 不支援 CSS 樣式"],
                answer: 1
            },
            {
                question: "在瀑布式卡片網頁中，每張卡片主要使用哪個 HTML 標籤？",
                options: ["&lt;section&gt;", "&lt;card&gt;", "&lt;div&gt;", "&lt;article&gt;"],
                answer: 2
            },
            {
                question: "GitHub Pages 可以免費部署什麼類型的網站？",
                options: ["需要資料庫的動態網站", "靜態網站（HTML/CSS/JS）", "需要後端伺服器的網站", "電子商務網站"],
                answer: 1
            },
            {
                question: "在 GitHub 上，「Fork」是什麼意思？",
                options: ["刪除別人的專案", "複製別人的專案到自己的帳號", "合併兩個專案", "評論別人的程式碼"],
                answer: 1
            },
            {
                question: "Netlify 相較於 GitHub Pages 的主要優勢是什麼？",
                options: ["支援環境變數設定", "完全免費無任何限制", "只能部署 HTML 網頁", "不需要註冊帳號"],
                answer: 0
            },
            {
                question: "Supabase 在課程中主要用來提供什麼服務？",
                options: ["程式碼編輯器", "雲端資料庫服務", "網頁版面設計", "GitHub 帳號管理"],
                answer: 1
            },
            {
                question: "CSS 的 Flexbox 主要用來做什麼？",
                options: ["添加動畫效果", "彈性排版佈局", "設定字體顏色", "建立資料庫連線"],
                answer: 1
            },
            {
                question: "README.md 檔案的主要用途是什麼？",
                options: ["存放程式碼", "專案說明文件", "設定環境變數", "管理使用者權限"],
                answer: 1
            },
            {
                question: "在部署網站時，「環境變數」通常用來存放什麼？",
                options: ["網頁的 HTML 程式碼", "API 金鑰等機密設定值", "圖片和影片檔案", "使用者的瀏覽紀錄"],
                answer: 1
            },
            {
                question: "JavaScript 在網頁中主要負責什麼功能？",
                options: ["定義網頁的結構與內容", "控制網頁的外觀樣式", "實現互動行為與動態邏輯", "管理伺服器的資料庫"],
                answer: 2
            }
        ];

        let quizQuestions = [];
        let userAnswers = [];
        let quizSubmitted = false;

        // Fisher-Yates 洗牌演算法
        function shuffleArray(arr) {
            const a = [...arr];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        // 初始化測驗：從 20 題中隨機抽 10 題
        function initQuiz() {
            quizQuestions = shuffleArray(allQuestions).slice(0, 10);
            const container = document.getElementById('quizContainer');
            if (!container) return;
            container.innerHTML = '';
            userAnswers = new Array(10).fill(-1);
            quizSubmitted = false;

            quizQuestions.forEach((q, qIndex) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                questionDiv.innerHTML = `
                    <h4>第 ${qIndex + 1} 題：${q.question}</h4>
                    <div class="options">
                        ${q.options.map((opt, oIndex) => `
                            <label class="quiz-option" data-q="${qIndex}" data-o="${oIndex}"
                                   onclick="selectOption(${qIndex}, ${oIndex})">
                                ${String.fromCharCode(65 + oIndex)}. ${opt}
                            </label>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }

        // 選擇選項
        function selectOption(qIndex, oIndex) {
            if (quizSubmitted) return;
            userAnswers[qIndex] = oIndex;
            const options = document.querySelectorAll(`[data-q="${qIndex}"]`);
            options.forEach((opt, idx) => {
                opt.classList.toggle('selected', idx === oIndex);
            });
        }

        // 送出測驗
        function submitQuiz() {
            const unanswered = userAnswers.filter(a => a === -1).length;
            if (unanswered > 0) {
                alert(`還有 ${unanswered} 題未作答！`);
                return;
            }
            quizSubmitted = true;

            let correctCount = 0;
            quizQuestions.forEach((q, idx) => {
                const isCorrect = userAnswers[idx] === q.answer;
                if (isCorrect) correctCount++;
                const options = document.querySelectorAll(`[data-q="${idx}"]`);
                options.forEach((opt, oIdx) => {
                    opt.classList.remove('selected');
                    if (oIdx === q.answer) opt.classList.add('correct');
                    else if (oIdx === userAnswers[idx] && !isCorrect) opt.classList.add('wrong');
                });
            });

            const score = correctCount * 10;
            const passed = score >= 80;

            document.getElementById('quizResult').classList.remove('hidden');
            document.getElementById('scoreDisplay').textContent = score;
            document.getElementById('resultMessage').innerHTML = passed
                ? '<div class="quiz-pass">&#x1F389; 恭喜通過認證！您可以領取證書了！</div>'
                : '<div class="quiz-fail">&#x274C; 未通過，需要 80 分以上才能取得證書</div>';

            document.getElementById('submitQuizBtn').classList.add('hidden');
            document.getElementById('retryQuizBtn').classList.remove('hidden');
            if (passed) document.getElementById('getCertBtn').classList.remove('hidden');

            // 滾動到結果區域
            document.getElementById('quizResult').scrollIntoView({ behavior: 'smooth' });
        }

        // 重新作答（重新抽題）
        function resetQuiz() {
            document.getElementById('quizResult').classList.add('hidden');
            document.getElementById('submitQuizBtn').classList.remove('hidden');
            document.getElementById('retryQuizBtn').classList.add('hidden');
            document.getElementById('getCertBtn').classList.add('hidden');
            initQuiz();
            // 滾動回頂部
            document.getElementById('quizContainer').scrollTop = 0;
        }

        // ========== 證書生成 ==========
        function generateCertificate() {
            const name = document.getElementById('recipientName').value.trim();
            const org = document.getElementById('recipientOrg').value.trim();
            if (!name) { alert('請輸入姓名！'); return; }

            document.getElementById('certName').textContent = name;
            document.getElementById('certOrg').textContent = org ? `（${org}）` : '';

            const today = new Date();
            document.getElementById('certDate').textContent =
                `${today.getFullYear()} 年 ${today.getMonth() + 1} 月 ${today.getDate()} 日`;

            document.getElementById('certForm').classList.add('hidden');
            document.getElementById('certificateDisplay').classList.remove('hidden');
        }

        // 下載證書（PNG）
        function downloadCertificate() {
            const cert = document.getElementById('certificate');
            if (typeof html2canvas === 'undefined') {
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
                script.onload = () => captureAndDownload(cert);
                document.head.appendChild(script);
            } else {
                captureAndDownload(cert);
            }
        }

        function captureAndDownload(element) {
            html2canvas(element, { scale: 2, backgroundColor: '#fffef0' }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'AI協作簡報實戰_認證證書.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }

        // ========== 簡報導航 ==========
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function init() {
            createIndicators();
            showSlide(0);
            updateButtons();
            document.addEventListener('keydown', handleKeydown);
            setTimeout(initQuiz, 200);
        }

        function handleKeydown(e) {
            if (e.target.tagName === 'INPUT') return; // 在輸入框中不觸發
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
            if (e.key === 'Home') goToSlide(0);
            if (e.key === 'End') goToSlide(totalSlides - 1);
        }

        function createIndicators() {
            const c = document.getElementById('indicatorContainer');
            c.innerHTML = '';
            slides.forEach((_, i) => {
                const d = document.createElement('div');
                d.className = 'dot';
                d.onclick = () => goToSlide(i);
                c.appendChild(d);
            });
        }

        function showSlide(i) {
            if (i < 0) i = 0;
            if (i >= totalSlides) i = totalSlides - 1;
            slides.forEach(s => s.classList.remove('active'));
            slides[i].classList.add('active');
            currentSlide = i;
            document.querySelectorAll('.dot').forEach((d, idx) => d.classList.toggle('active', idx === i));
            updateButtons();
            document.getElementById('pageIndicator').textContent = `${i + 1} / ${totalSlides}`;
        }

        function changeSlide(d) { showSlide(currentSlide + d); }
        function goToSlide(i) { showSlide(i); }
        function updateButtons() {
            document.getElementById('prevBtn').disabled = currentSlide === 0;
            document.getElementById('nextBtn').disabled = currentSlide === totalSlides - 1;
        }
        function toggleFullscreen() {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else if (document.exitFullscreen) document.exitFullscreen();
        }

        init();
    </script>
</body>
</html>
